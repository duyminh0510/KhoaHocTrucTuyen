<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
    th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

    <head>
        <meta charset="UTF-8">
        <title>Chi tiết khoá học</title>
        <style>
        .course-detail-container {
            max-width: 900px;
            margin: 48px auto;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 16px rgba(34, 49, 79, 0.09);
            padding: 40px 36px 32px 36px;
            display: flex;
            gap: 40px;
        }
        
        .course-detail-thumb {
            width: 340px;
            height: 220px;
            object-fit: cover;
            border-radius: 14px;
            box-shadow: 0 2px 8px rgba(34, 49, 79, 0.07);
        }
        
        .course-detail-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .course-detail-title {
            font-size: 28px;
            font-weight: bold;
            color: #22314f;
            margin-bottom: 16px;
        }
        
        .course-detail-desc {
            color: #444;
            font-size: 17px;
            margin-bottom: 18px;
        }
        
        .course-detail-meta {
            font-size: 15px;
            color: #666;
            margin-bottom: 12px;
        }
        
        .course-detail-price {
            font-size: 22px;
            color: #d32f2f;
            font-weight: 700;
            margin-bottom: 18px;
        }
        
        .btn-detail {
            font-size: 18px;
            padding: 12px 32px;
            border-radius: 8px;
        }
        
        body {
            font-family: 'Times New Roman', Times, serif;
        }
    </style>
    </head>

    <body>
        <main class="khoahocchitiet">
            <div class="course-detail-container">
                <img
                    th:src="${khoaHoc.anhBia != null ? '/photos/' + khoaHoc.anhBia : '/photos/logochinh.png'}"
                    alt="Ảnh khoá học" class="course-detail-thumb" />
                <div class="course-detail-info">
                    <div class="course-detail-title"
                        th:text="${khoaHoc.tenKhoaHoc}"></div>
                    <div class="course-detail-desc"
                        th:text="${khoaHoc.moTa}"></div>
                    <div class="course-detail-meta">
                        <span>Giảng viên: <b
                                th:text="${khoaHoc.giangVien.accounts.name}"></b></span><br>
                        <span>Danh mục: <b
                                th:text="${khoaHoc.danhMuc.tenDanhMuc}"></b></span>
                    </div>
                    <div class="course-detail-price">
                        <span th:if="${khoaHoc.giaKhuyenMai != null}"
                            th:text="${#numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT')} + ' đ'"></span>
                        <span th:if="${khoaHoc.giaKhuyenMai == null}"
                            th:text="${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT')} + ' đ'"></span>
                    </div>
                    <div>
                        <button class="btn-detail"
                            onclick="showPaymentForm()">Mua khoá học</button>
                        <!-- Nếu đã mua thì hiện nút Vào học -->
                        <!-- <a href="/hocvien/vaohoc/[[${khoaHoc.courseId}]]" class="btn-detail">Vào học</a> -->
                    </div>
                </div>
            </div>
            <!-- Popup thanh toán -->
            <div id="payment-popup"
                style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(34,49,79,0.18); z-index:9999; align-items:center; justify-content:center;">
                <div
                    style="background:#fff; border-radius:16px; box-shadow:0 2px 16px rgba(34,49,79,0.13); padding:36px 32px; min-width:340px; max-width:96vw; margin:auto; position:relative;">
                    <h2
                        style="font-size:22px; color:#22314f; font-weight:700; margin-bottom:18px;">Thanh
                        toán khoá học</h2>
                    <form method="post" action="#">
                        <div style="margin-bottom:16px;">
                            <label for="hinhThucThanhToan"
                                style="font-weight:600;">Hình thức thanh
                                toán</label><br>
                            <select id="hinhThucThanhToan"
                                name="hinhThucThanhToan"
                                style="width:100%; padding:8px 10px; border-radius:6px; border:1px solid #bbb; font-size:16px;">
                                <option value>-- Chọn --</option>
                                <option value="VNPAY">VNPAY</option>
                                <option value="MOMO">MOMO</option>
                            </select>
                        </div>
                        <div style="margin-bottom:16px;">
                            <label for="tenhocvien" style="font-weight:600;">Tên
                                học viên</label><br>
                            <input type="text" id="tenhocvien" name="tenhocvien"
                                style="width:100%; padding:8px 10px; border-radius:6px; border:1px solid #bbb; font-size:16px;"
                                th:value="${tenHocVien}" required>
                        </div>
                        <div style="margin-bottom:16px;">
                            <label for="tongtien" style="font-weight:600;">Tổng
                                tiền</label><br>
                            <input type="text" id="tongtien" name="tongtien"
                                style="width:100%; padding:8px 10px; border-radius:6px; border:1px solid #bbb; font-size:16px; background:#f7f7f7;"
                                th:value="${khoaHoc.giaKhuyenMai != null ? #numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT') + ' đ' : #numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT') + ' đ'}"
                                readonly>
                        </div>
                        <div
                            style="display:flex; gap:16px; justify-content:flex-end;">
                            <button type="submit" class="btn-detail">Xác nhận
                                thanh toán</button>
                            <button type="button" class="btn-detail btn-outline"
                                onclick="hidePaymentForm()">Đóng</button>
                        </div>
                    </form>
                </div>
            </div>

            <script>
            function showPaymentForm() {
                document.getElementById('payment-popup').style.display = 'flex';
            }

            function hidePaymentForm() {
                document.getElementById('payment-popup').style.display = 'none';
            }
        </script>
        </main>

    </body>

</html>