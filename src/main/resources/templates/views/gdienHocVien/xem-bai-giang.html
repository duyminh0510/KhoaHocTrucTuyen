<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>[[${baiGiang.tenBaiGiang}]]</title>
    <link rel="stylesheet" href="/css/hocVien/xem-bai-giang.css">
</head>
<body>
    <div class="lesson-container">
        <!-- Header bài giảng -->
        <div class="lesson-header">
            <div class="lesson-info">
                <h1 th:text="${baiGiang.tenBaiGiang}">Tên bài giảng</h1>
                <div class="lesson-meta">
                    <span class="duration"><i class="fas fa-clock"></i> [[${baiGiang.thoiGian}]] phút</span>
                    <span class="progress"><i class="fas fa-play-circle"></i> Đang học</span>
                </div>
            </div>
            <div class="lesson-actions">
                <a href="/hoc-tap/khoa-hoc/1" class="btn-back">← Quay lại khóa học</a>
            </div>
        </div>

        <!-- Nội dung bài giảng -->
        <div class="lesson-content">
            <!-- Video player -->
            <div class="video-section">
                <div class="video-container">
                    <video id="lesson-video" controls poster="/photos/video-poster.jpg">
                        <source th:src="@{'/videos/' + ${baiGiang.videoUrl}}" type="video/mp4">
                        Trình duyệt của bạn không hỗ trợ video.
                    </video>
                    <div class="video-overlay">
                        <div class="play-button" onclick="playVideo()">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Video controls -->
                <div class="video-controls">
                    <div class="control-group">
                        <button class="control-btn" onclick="togglePlayPause()">
                            <i class="fas fa-play" id="play-icon"></i>
                        </button>
                        <div class="progress-bar">
                            <div class="progress-fill" id="video-progress"></div>
                        </div>
                        <span class="time-display">
                            <span id="current-time">0:00</span> / <span id="total-time">0:00</span>
                        </span>
                    </div>
                    <div class="control-group">
                        <button class="control-btn" onclick="toggleMute()">
                            <i class="fas fa-volume-up" id="volume-icon"></i>
                        </button>
                        <input type="range" id="volume-slider" min="0" max="100" value="100">
                        <button class="control-btn" onclick="toggleFullscreen()">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Thông tin bài giảng -->
            <div class="lesson-details">
                <div class="lesson-description">
                    <h3>Mô tả bài học</h3>
                    <p th:text="${baiGiang.moTa}">Mô tả bài học</p>
                </div>
                
                <div class="lesson-content-text">
                    <h3>Nội dung bài học</h3>
                    <div class="content-text" th:text="${baiGiang.noiDung}">Nội dung chi tiết</div>
                </div>

                <!-- Tài liệu đính kèm -->
                <div class="lesson-attachments">
                    <h3>Tài liệu đính kèm</h3>
                    <div class="attachment-list">
                        <div class="attachment-item">
                            <i class="fas fa-file-pdf"></i>
                            <span>Slide bài giảng</span>
                            <a href="#" class="btn-download">Tải xuống</a>
                        </div>
                        <div class="attachment-item">
                            <i class="fas fa-file-code"></i>
                            <span>Code mẫu</span>
                            <a href="#" class="btn-download">Tải xuống</a>
                        </div>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="lesson-navigation">
                    <button class="btn-nav btn-prev" onclick="previousLesson()">
                        <i class="fas fa-chevron-left"></i> Bài trước
                    </button>
                    <button class="btn-nav btn-next" onclick="nextLesson()">
                        Bài tiếp <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const video = document.getElementById('lesson-video');
        const playIcon = document.getElementById('play-icon');
        const volumeIcon = document.getElementById('volume-icon');
        const progressFill = document.getElementById('video-progress');
        const currentTimeSpan = document.getElementById('current-time');
        const totalTimeSpan = document.getElementById('total-time');
        const volumeSlider = document.getElementById('volume-slider');

        // Video controls
        function playVideo() {
            video.play();
            document.querySelector('.video-overlay').style.display = 'none';
        }

        function togglePlayPause() {
            if (video.paused) {
                video.play();
                playIcon.className = 'fas fa-pause';
            } else {
                video.pause();
                playIcon.className = 'fas fa-play';
            }
        }

        function toggleMute() {
            if (video.muted) {
                video.muted = false;
                volumeIcon.className = 'fas fa-volume-up';
            } else {
                video.muted = true;
                volumeIcon.className = 'fas fa-volume-mute';
            }
        }

        function toggleFullscreen() {
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        }

        // Update progress bar
        video.addEventListener('timeupdate', function() {
            const progress = (video.currentTime / video.duration) * 100;
            progressFill.style.width = progress + '%';
            currentTimeSpan.textContent = formatTime(video.currentTime);
        });

        // Update total time when metadata is loaded
        video.addEventListener('loadedmetadata', function() {
            totalTimeSpan.textContent = formatTime(video.duration);
        });

        // Volume control
        volumeSlider.addEventListener('input', function() {
            video.volume = this.value / 100;
            if (this.value == 0) {
                volumeIcon.className = 'fas fa-volume-mute';
            } else if (this.value < 50) {
                volumeIcon.className = 'fas fa-volume-down';
            } else {
                volumeIcon.className = 'fas fa-volume-up';
            }
        });

        // Click on progress bar to seek
        document.querySelector('.progress-bar').addEventListener('click', function(e) {
            const rect = this.getBoundingClientRect();
            const pos = (e.clientX - rect.left) / rect.width;
            video.currentTime = pos * video.duration;
        });

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;
        }

        function previousLesson() {
            // Navigate to previous lesson
            alert('Chuyển đến bài trước');
        }

        function nextLesson() {
            // Navigate to next lesson
            alert('Chuyển đến bài tiếp');
        }

        // Auto-hide overlay when video starts
        video.addEventListener('play', function() {
            document.querySelector('.video-overlay').style.display = 'none';
        });
    </script>
</body>
</html> 