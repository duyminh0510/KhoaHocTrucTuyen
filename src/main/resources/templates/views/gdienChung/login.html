<!DOCTYPE html>
<html
  lang="vi"
  th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Globaledu Login</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <main class="login">
      <section>
        <div
          class="container-fluid"
          style="margin-top: 65px; margin-bottom: 65px"
        >
          <div
            class="row d-flex justify-content-center align-items-center h-100"
          >
            <!-- C·ªôt h√¨nh ·∫£nh -->
            <div
              class="col-md-6 d-flex justify-content-center align-items-center"
            >
              <img
                th:src="@{/photos/logodangnhap.png}"
                class="img-fluid custom-img"
                alt="H·ªçc t·∫≠p online"
              />
            </div>

            <!-- Form ƒëƒÉng nh·∫≠p -->
            <div class="col-md-6">
              <div style="width: 100%; max-width: 450px">
                <h2 class="text-center mb-4">
                  üîë ƒêƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c h·ªçc t·∫≠p n√†o b·∫°n
                </h2>

                <form
                  th:action="@{/auth/login/form}"
                  method="post"
                  class="needs-validation"
                  novalidate
                >
                  <!-- Email -->
                  <div class="mb-4">
                    <label class="form-label">Email</label>
                    <input
                      type="email"
                      name="email"
                      class="form-control"
                      placeholder="Nh·∫≠p email"
                      autocomplete="off"
                      required
                      pattern="^[a-zA-Z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                      title="Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email h·ª£p l·ªá"
                      th:value="${email}"
                    />
                    <div class="invalid-feedback">
                      Vui l√≤ng nh·∫≠p email h·ª£p l·ªá.
                    </div>
                  </div>

                  <!-- M·∫≠t kh·∫©u -->
                  <div class="mb-4">
                    <label class="form-label">M·∫≠t kh·∫©u</label>
                    <input
                      type="password"
                      name="password"
                      class="form-control"
                      placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                      autocomplete="new-password"
                      required
                      minlength="6"
                      title="M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±"
                    />
                    <div class="invalid-feedback">
                      M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.
                    </div>
                  </div>

                  <!-- L·ªói t·ª´ controller -->
                  <div th:if="${error}" class="mb-3">
                    <p class="text-danger" th:text="${error}"></p>
                  </div>

                  <div class="text-center">
                    <button class="btn btn-primary w-100" type="submit">
                      ƒêƒÉng nh·∫≠p
                    </button>
                  </div>

                  <div class="text-center mt-3">
                    <div class="d-flex align-items-center text-center my-3">
                      <hr class="flex-grow-1 me-2" />
                      <p class="mb-0">T√πy ch·ªçn ƒëƒÉng nh·∫≠p kh√°c:</p>
                      <hr class="flex-grow-1 ms-2" />
                    </div>

                    <div class="d-flex justify-content-center">
                      <a
                        href="#"
                        class="btn-google"
                        data-bs-toggle="tooltip"
                        data-bs-placement="top"
                        title="ƒêƒÉng nh·∫≠p b·∫±ng Google"
                      >
                        <img
                          th:src="@{/photos/google.png}"
                          alt="ƒêƒÉng nh·∫≠p v·ªõi Google"
                        />
                      </a>
                    </div>
                  </div>

                  <div class="text-center mt-3">
                    Kh√¥ng c√≥ t√†i kho·∫£n?
                    <a style="text-decoration: none" th:href="@{/auth/dangky}"
                      >ƒêƒÉng k√Ω</a
                    >
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Modal th√¥ng b√°o -->
      <div
        class="modal fade"
        id="alertModal"
        tabindex="-1"
        aria-labelledby="alertModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content border-0 shadow-lg rounded-3">
            <div class="modal-header bg-primary text-white">
              <h5 class="modal-title" id="alertModalLabel">
                <i class="bi bi-exclamation-circle-fill me-2"></i>Th√¥ng b√°o
              </h5>
              <button
                type="button"
                class="btn-close btn-close-white"
                data-bs-dismiss="modal"
                aria-label="ƒê√≥ng"
              ></button>
            </div>
            <div class="modal-body fs-5 text-dark" id="modal-message"></div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-outline-primary"
                data-bs-dismiss="modal"
              >
                ƒê√≥ng
              </button>
            </div>
          </div>
        </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

      <!-- JS Validation v√† Modal -->
      <script th:inline="javascript">
        /*<![CDATA[*/
        // Hi·ªÉn th·ªã modal khi c√≥ th√¥ng b√°o
        let logout = /*[[${param.logout}]]*/ false;
        let unauthorized = /*[[${param.error}]]*/ null;
        let flashError = /*[[${error}]]*/ null;

        let message = null;
        if (logout) {
          message = "ƒêƒÉng xu·∫•t th√†nh c√¥ng.";
        } else if (unauthorized && unauthorized.includes("unauthorized")) {
          message = "B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p v√†o trang n√†y.";
        } else if (flashError) {
          message = flashError;
        }

        if (message) {
          const modalEl = document.getElementById("alertModal");
          document.getElementById("modal-message").textContent = message;
          const modal = new bootstrap.Modal(modalEl);
          modal.show();
        }

        // Bootstrap validation
        (() => {
          "use strict";
          const forms = document.querySelectorAll(".needs-validation");
          Array.from(forms).forEach((form) => {
            form.addEventListener(
              "submit",
              (event) => {
                if (!form.checkValidity()) {
                  event.preventDefault();
                  event.stopPropagation();
                }
                form.classList.add("was-validated");
              },
              false
            );
          });
        })();
        /*]]>*/
      </script>
    </main>
  </body>
</html>
