<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
    th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Kết quả tìm kiếm - GlobalEdu</title>
    </head>

    <body>
        <main class="search-results">
            <div class="container">
                <!-- Thông báo lỗi -->
                <div class="alert alert-danger" th:if="${error}" role="alert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span th:text="${error}"></span>
                </div>

                <!-- Thông báo kết quả tìm kiếm -->
                <div th:if="${query != null and query != ''}">
                    <div class="results-info">
                        <h4>
                            <i class="fas fa-search"></i> Tìm kiếm từ khóa "
                            <span th:text="${query}"></span>" - Tìm thấy <span
                                th:text="${soLuongKetQua}"></span> kết quả
                        </h4>
                    </div>
                </div>

                <!-- Danh sách khóa học nếu có kết quả -->
                <div th:if="${!ketQuaTimKiem.isEmpty()}">
                    <div class="course-grid">
                        <div class="course-card"
                            th:each="khoaHoc : ${ketQuaTimKiem}">
                            <img th:src="${khoaHoc.anhBia}"
                                th:alt="${khoaHoc.tenKhoaHoc}">
                            <div class="card-body">
                                <h5 th:text="${khoaHoc.tenKhoaHoc}"></h5>
                                <div class="price">
                                    <span class="original-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-badge"
                                        th:if="${khoaHoc.phanTramGiam > 0}"
                                        th:text="'-' + ${khoaHoc.phanTramGiam} + '%'" />
                                </div>
                                <a
                                    th:href="@{'/khoa-hoc/' + ${khoaHoc.khoahocId}}"
                                    class="btn-view">
                                    <i class="fas fa-eye"></i> Xem chi tiết
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Không có kết quả: Gợi ý khoá học -->
                <div
                    th:if="${ketQuaTimKiem.isEmpty() and query != null and query != ''}">
                    <div class="results-info">
                        <h4><i class="fas fa-lightbulb"></i> Gợi ý khoá học cho
                            bạn
                        </h4>
                    </div>
                    <div class="course-grid">
                        <div class="course-card"
                            th:each="khoaHoc : ${goiYKhoaHoc}">
                            <img th:src="${khoaHoc.anhBia}"
                                th:alt="${khoaHoc.tenKhoaHoc}">
                            <div class="card-body">
                                <h5 th:text="${khoaHoc.tenKhoaHoc}"></h5>
                                <div class="price">
                                    <span class="original-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-badge"
                                        th:if="${khoaHoc.phanTramGiam > 0}"
                                        th:text="'-' + ${khoaHoc.phanTramGiam} + '%'" />
                                </div>
                                <a
                                    th:href="@{'/khoa-hoc/' + ${khoaHoc.khoahocId}}"
                                    class="btn-view">
                                    <i class="fas fa-eye"></i> Xem chi tiết
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hiển thị tất cả khóa học khi không có từ khóa tìm kiếm -->
                <div th:if="${query == null or query == ''}">
                    <div class="results-info">
                        <h4><i class="fas fa-list"></i> Tất cả khóa học</h4>
                        <p>Có <strong th:text="${soLuongKetQua}"></strong> khóa
                            học đang hoạt động</p>
                    </div>
                    <div class="course-grid">
                        <div class="course-card"
                            th:each="khoaHoc : ${ketQuaTimKiem}">
                            <img th:src="${khoaHoc.anhBia}"
                                th:alt="${khoaHoc.tenKhoaHoc}">
                            <div class="card-body">
                                <h5 th:text="${khoaHoc.tenKhoaHoc}"></h5>
                                <div class="price">
                                    <span class="original-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-price"
                                        th:text="'₫' + ${#numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT')}"></span>
                                    <span class="discount-badge"
                                        th:if="${khoaHoc.phanTramGiam > 0}"
                                        th:text="'-' + ${khoaHoc.phanTramGiam} + '%'" />
                                </div>
                                <a
                                    th:href="@{'/khoa-hoc/' + ${khoaHoc.khoahocId}}"
                                    class="btn-view">
                                    <i class="fas fa-eye"></i> Xem chi tiết
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script th:src="@{/js/timkiem.js}"></script>
        </main>
    </body>

</html>