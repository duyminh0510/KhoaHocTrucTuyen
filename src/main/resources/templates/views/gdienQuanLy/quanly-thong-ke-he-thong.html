<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
    th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

    <head>
        <meta charset="UTF-8">
        <title>Th·ªëng k√™ h·ªá th·ªëng</title>
    </head>

    <body>
        <main class="thongkeadmin">
            <div class="container-fluid px-4">
                <h1 class="mt-4">üìä Th·ªëng k√™ h·ªá th·ªëng</h1>
                <ol class="breadcrumb mb-4">
                    <li><a href="/admin/dashboard">B·∫£ng ƒëi·ªÅu khi·ªÉn</a></li>
                    <li>/ Th·ªëng k√™</li>
                </ol>

                <!-- Info Cards -->
                <div class="row">
                    <div class="info-card bg-blue">
                        <div class="card-content">
                            <i class="fas fa-user-graduate"></i>
                            <div class="card-text">
                                <div th:text="${tongHocVien}">0</div>
                                <a href="/admin/quanly-hocvien">T·ªïng s·ªë h·ªçc
                                    vi√™n</a>
                            </div>
                        </div>
                    </div>

                    <div class="info-card bg-yellow">
                        <div class="card-content">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <div class="card-text">
                                <div th:text="${tongGiangVien}">0</div>
                                <a href="/admin/quanly-giangvien">T·ªïng s·ªë gi·∫£ng
                                    vi√™n</a>
                            </div>
                        </div>
                    </div>

                    <div class="info-card bg-green">
                        <div class="card-content">
                            <i class="fas fa-book-open"></i>
                            <div class="card-text">
                                <div th:text="${tongKhoaHoc}">0</div>
                                <a href="#">T·ªïng s·ªë kh√≥a h·ªçc</a>
                            </div>
                        </div>
                    </div>

                    <div class="info-card bg-orange">
                        <div class="card-content">
                            <i class="fas fa-user-tie"></i>
                            <div class="card-text">
                                <div th:text="${tongNhanVien}">0</div>
                                <a href="/admin/quanly-nhanvien">T·ªïng s·ªë nh√¢n
                                    vi√™n</a>
                            </div>
                        </div>
                    </div>

                    <div class="info-card bg-red">
                        <div class="card-content">
                            <i class="fas fa-dollar-sign"></i>
                            <div class="card-text">
                                <div
                                    th:text="${#numbers.formatDecimal(doanhThuThang, 0, 'COMMA', 0, 'POINT')} + 'ƒë'">0ƒë
                                </div>
                                <a href="#">Doanh thu th√°ng n√†y</a>
                            </div>
                        </div>
                    </div>

                    <div class="info-card bg-red">
                        <div class="card-content">
                            <i class="fas fa-dollar-sign"></i>
                            <div class="card-text">
                                <div
                                    th:text="${#numbers.formatDecimal(tongTienNenTang, 0, 'COMMA', 0, 'POINT')} + 'ƒë'">0ƒë
                                </div>
                                <a href="#">T·ªïng ƒë√£ nh·∫≠n</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="chart-container">
                    <div class="chart-box" style="flex: 1 1 65%;">
                        <div class="title"><i class="fas fa-chart-bar me-1"></i>
                            Doanh thu 6 th√°ng g·∫ßn nh·∫•t</div>
                        <canvas id="revenueChart" width="100%"
                            height="40"></canvas>
                    </div>
                    <div class="chart-box" style="flex: 1 1 30%;">
                        <div class="title"><i class="fas fa-chart-pie me-1"></i>
                            T·ªâ l·ªá danh m·ª•c kh√≥a h·ªçc</div>
                        <canvas id="categoryChart" width="100%"
                            height="40"></canvas>
                    </div>
                </div>

                <!-- Table -->
                <div class="table-container">
                    <div class="title"><i class="fas fa-table me-1"></i> Th·ªëng
                        k√™ chi ti·∫øt kh√≥a h·ªçc</div>
                    <table>
                        <thead>
                            <tr>
                                <th>T√™n kh√≥a h·ªçc</th>
                                <th>L∆∞·ª£t mua</th>
                                <th>Doanh thu</th>
                                <th>S·ªë l∆∞·ª£t th√≠ch</th>
                                <th>Gi·∫£ng vi√™n</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="khoaHoc : ${chiTietKhoaHoc}">
                                <td th:text="${khoaHoc[0]}">T√™n</td>
                                <td th:text="${khoaHoc[1]}">0</td>
                                <td
                                    th:text="${#numbers.formatDecimal(khoaHoc[2], 0, 'COMMA', 0, 'POINT')} + 'ƒë'">0ƒë</td>
                                <td th:text="${khoaHoc[3]}">0</td>
                                <td th:text="${khoaHoc[4]}">T√™n GV</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <script th:inline="javascript">
            /*<![CDATA[*/
            var revenueData = /*[[${revenueData}]]*/ [];
            var categoryData = /*[[${categoryData}]]*/ {};
            /*]]>*/
        </script>

            <!-- Script v·∫Ω bi·ªÉu ƒë·ªì -->
            <script>
            var ctx = document.getElementById('revenueChart').getContext('2d');
            var monthLabels = [];
            var now = new Date();
            for (var i = 5; i >= 0; i--) {
                var d = new Date(now.getFullYear(), now.getMonth() - i, 1);
                monthLabels.push('Th√°ng ' + (d.getMonth() + 1));
            }
            var revenueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: monthLabels,
                    datasets: [{
                        label: 'Doanh thu (VNƒê)',
                        data: revenueData,
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString('vi-VN') + '‚Ç´';
                                }
                            }
                        }
                    }
                }
            });

            var ctx2 = document.getElementById('categoryChart').getContext('2d');
            var categoryLabels = Object.keys(categoryData);
            var categoryValues = Object.values(categoryData);
            var categoryChart = new Chart(ctx2, {
                type: 'pie',
                data: {
                    labels: categoryLabels,
                    datasets: [{
                        data: categoryValues,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.5)',
                            'rgba(54, 162, 235, 0.5)',
                            'rgba(255, 206, 86, 0.5)',
                            'rgba(75, 192, 192, 0.5)',
                            'rgba(153, 102, 255, 0.5)',
                            'rgba(255, 159, 64, 0.5)'
                        ]
                    }]
                }
            });
        </script>
        </main>
    </body>

</html>