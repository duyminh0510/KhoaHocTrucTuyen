<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi"
  th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

<head>
  <meta charset="UTF-8">
  <title>Quản lý nhân viên</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
</head>

<body>
  <main class="container py-4">
    <h2 class="mb-4 text-center">Quản lý nhân viên</h2>

    <!-- Form thêm hoặc sửa -->
    <form class="border p-4 rounded shadow-sm mb-4"
      th:action="@{${nhanvien.taikhoanId == null} ? '/admin/quanly-nhanvien/add' : '/admin/quanly-nhanvien/edit'}"
      method="post" enctype="multipart/form-data" th:object="${nhanvien}">
      <input type="hidden" th:field="*{taikhoanId}" />

      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Họ tên:</label>
        <div class="col-sm-10">
          <input type="text" th:field="*{name}" class="form-control" required />
        </div>
      </div>

      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Email:</label>
        <div class="col-sm-10">
          <input type="email" th:field="*{email}" class="form-control" required />
        </div>
      </div>

      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Số điện thoại:</label>
        <div class="col-sm-10">
          <input type="text" th:field="*{phone}" class="form-control" required />
        </div>
      </div>

      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Mật khẩu:</label>
        <div class="col-sm-10">
          <!-- Nếu thêm mới -->
          <input type="password" th:if="${nhanvien.taikhoanId == null}" th:field="*{password}" class="form-control"
            required />

          <!-- Nếu đang sửa -->
          <input type="password" th:if="${nhanvien.taikhoanId != null}" value="******" readonly disabled
            class="form-control" style="background-color: #e9ecef; cursor: not-allowed;" />
        </div>
      </div>

      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Ảnh đại diện:</label>
        <div class="col-sm-10">
          <input type="file" name="avatarFile" class="form-control" />
        </div>
      </div>

      <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary me-2"
          th:text="${nhanvien.taikhoanId == null} ? 'Thêm mới' : 'Cập nhật'"></button>
        <a th:href="@{/admin/quanly-nhanvien}" class="btn btn-secondary">Làm mới form</a>
      </div>
    </form>

    <!-- Danh sách nhân viên -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Họ tên</th>
            <th>Email</th>
            <th>Điện thoại</th>
            <th>Ảnh</th>
            <th>Hành động</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="nv : ${nhanviens}">
            <td th:text="${nv.taikhoanId}"></td>
            <td th:text="${nv.name}"></td>
            <td th:text="${nv.email}"></td>
            <td th:text="${nv.phone}"></td>
            <td>
              <img th:src="@{${nv.avatar}}" width="60" height="60" alt="avatar" class="rounded-circle" />
            </td>
            <td>
              <a th:href="@{'/admin/quanly-nhanvien/edit/' + ${nv.taikhoanId}}" class="btn btn-sm btn-warning">Sửa</a>
              <form th:action="@{'/admin/quanly-nhanvien/delete/' + ${nv.taikhoanId}}" method="post"
                onsubmit="return confirm('Bạn có chắc muốn xóa?');" style="display:inline;">
                <button type="submit" class="btn btn-sm btn-danger ms-1">Xóa</button>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</body>

</html>