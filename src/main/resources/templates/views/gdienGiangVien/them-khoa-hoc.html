<!DOCTYPE html>
<html
  lang="vi"
  th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thêm khoá học - Bước 1</title>
  </head>

  <body>
    <main class="themkhoahoc">
      <div class="container">
        <h2 class="main-title mt-5">
          <i class="fas fa-graduation-cap me-2 fonsomed-icon"></i>THÊM KHÓA HỌC
          - BƯỚC 1
        </h2>

        <form
          th:action="@{/giangvien/them-moi-khoa-hoc/save-info}"
          th:object="${course}"
          method="post"
          enctype="multipart/form-data"
          class="mb-5"
          id="formAdd"
        >
          <input type="hidden" th:field="*{khoahocId}" />

          <!-- Tên khóa học -->
          <label>
            <i class="fas fa-book me-1 text-primary"></i>Tên khóa học:
          </label>
          <input
            type="text"
            th:field="*{tenKhoaHoc}"
            id="tenKhoaHoc"
            placeholder="VD: Java cho người mới bắt đầu"
            autocomplete="off"
            required
          />
          <p
            th:if="${#fields.hasErrors('tenKhoaHoc')}"
            th:errors="*{tenKhoaHoc}"
            class="text-danger"
          ></p>
          <p id="tenKhoaHoc-error" class="text-danger"></p>

          <!-- Mô tả khóa học -->
          <label>
            <i class="fas fa-align-left me-1 text-primary"></i>Mô tả khóa học:
          </label>
          <textarea
            th:field="*{moTa}"
            rows="5"
            placeholder="Mô tả chi tiết..."
          ></textarea>
          <p
            th:if="${#fields.hasErrors('moTa')}"
            th:errors="*{moTa}"
            class="text-danger"
          ></p>

          <!-- Danh mục -->
          <label>
            <i class="fas fa-layer-group me-1 text-primary"></i>Danh mục:
          </label>
          <select th:field="*{danhMuc.danhmucId}">
            <option
              th:each="c : ${danhmuc}"
              th:value="${c.danhmucId}"
              th:text="${c.tenDanhMuc}"
            ></option>
          </select>

          <!-- Video giới thiệu -->
          <label>
            <i class="fas fa-video me-1 text-primary"></i>Video giới thiệu:
          </label>
          <input
            type="text"
            name="urlGioiThieu"
            th:value="*{urlGioiThieu}"
            placeholder="https://..."
            pattern="^(https?:\/\/)?(www\.youtube\.com|youtu\.be)\/.+$"
            title="Link video của bạn không hợp lệ (ví dụ: https://youtu.be/abc123)"
          />

          <!-- Ảnh bìa -->
          <label>
            <i class="fas fa-image me-1 text-primary"></i>Ảnh bìa khóa học:
          </label>
          <input type="file" name="file" />
          <p
            th:if="${imageError != null}"
            th:text="${imageError}"
            class="text-danger"
          ></p>

          <!-- Submit -->
          <div class="d-flex justify-content-end">
            <button class="btn custom-outline" type="submit">
              Tiếp tục<i class="fas fa-arrow-right ms-2 fonsomed-icon"></i>
            </button>
          </div>
        </form>
      </div>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const input = document.getElementById("tenKhoaHoc");
        const errorMsg = document.getElementById("tenKhoaHoc-error");
        const form = document.getElementById("formAdd");

        // Regex: chỉ cho chữ, số, khoảng trắng, dấu tiếng Việt
        const regex = /^[a-zA-Z0-9À-ỹ\s]+$/;

        input.addEventListener("input", () => {
          const value = input.value.trim();
          if (!regex.test(value)) {
            errorMsg.textContent =
              "Tên khóa học không được chứa ký tự đặc biệt.";
          } else {
            errorMsg.textContent = "";
          }
        });

        form.addEventListener("submit", function (e) {
          const value = input.value.trim();
          if (!regex.test(value)) {
            e.preventDefault();
            errorMsg.textContent =
              "Tên khóa học không được chứa ký tự đặc biệt.";
          }
        });
      });
    </script>
  </body>
</html>
