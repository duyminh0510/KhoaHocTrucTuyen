<!DOCTYPE html>
<html lang="vi"
    th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

    <head>
        <title th:fragment="title">Kh√≥a h·ªçc ƒë√£ t·∫°o</title>
    </head>

    <body>
        <main th:fragment="main" class="container py-5 khoahocdatao">
            <h1 class="text-center mb-5">Kho√° h·ªçc ƒë√£ t·∫°o</h1>

            <div class="mb-4">
                <form method="get" th:action="@{/giangvien/khoa-hoc-da-tao}"
                    class="search-form">
                    <div class="search-group">
                        <input type="text" class="form-control" name="keyword"
                            placeholder="T√¨m ki·∫øm kho√° h·ªçc..."
                            th:value="${keyword}" />
                        <button class="btn btn-success"
                            type="submit">T√¨m</button>
                    </div>
                </form>

            </div>

            <div class="row courses-grid">
                <!-- N·∫øu kh√¥ng c√≥ kho√° h·ªçc n√†o -->
                <div th:if="${#lists.isEmpty(khoaHocList)}"
                    class="text-center text-muted my-5">
                    <p class="fs-5">üòî Kh√¥ng t√¨m th·∫•y kho√° h·ªçc n√†o ph√π h·ª£p v·ªõi
                        t·ª´ kho√° "<span th:text="${keyword}">...</span>".</p>
                </div>
                <th:block th:each="khoaHoc : ${khoaHocList}">
                    <div class="col-12 col-sm-6 col-lg-3 mb-4">
                        <div class="card h-100 shadow-sm course-card"
                            th:onclick="|window.location.href='/khoaHoc/${khoaHoc.khoahocId}'|">

                            <img class="card-img-top" th:src="${khoaHoc.anhBia}"
                                alt="·∫¢nh kho√° h·ªçc" />

                            <div class="card-body d-flex flex-column pb-0">
                                <h5 class="card-title"
                                    th:text="${khoaHoc.tenKhoaHoc}">T√™n kho√° h·ªçc
                                </h5>
                                <p class="card-text small text-muted mt-auto">
                                    <i
                                        class="fas fa-chalkboard-teacher me-1"></i>
                                    Gi·∫£ng vi√™n:
                                    <span
                                        th:text="${khoaHoc.giangVien?.taikhoan?.name ?: 'ƒêang c·∫≠p nh·∫≠t'}">T√™n
                                        GV</span>
                                </p>
                            </div>

                            <div class="card-footer pt-0">
                                <div class="mb-2">
                                    <p
                                        th:if="${khoaHoc.giaKhuyenMai != null and khoaHoc.giaKhuyenMai > 0}">
                                        <span class="fw-bold text-danger me-2"
                                            th:text="${#numbers.formatDecimal(khoaHoc.giaKhuyenMai, 0, 'COMMA', 0, 'POINT') + ' ‚Ç´'}"></span>
                                        <del class="text-muted"
                                            th:text="${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT') + ' ‚Ç´'}"></del>
                                    </p>
                                    <p
                                        th:if="${khoaHoc.giaKhuyenMai == null or khoaHoc.giaKhuyenMai == 0}">
                                        <span class="fw-bold"
                                            th:text="${#numbers.formatDecimal(khoaHoc.giagoc, 0, 'COMMA', 0, 'POINT') + ' ‚Ç´'}"></span>
                                    </p>
                                </div>

                                <div
                                    class="d-flex justify-content-between align-items-center gap-1">
                                    <button type="button"
                                        class="btn btn-sm like-btn"
                                        th:id="'like-btn-' + ${khoaHoc.khoahocId}"
                                        th:classappend="${likedCourseIds?.contains(khoaHoc.khoahocId)} ? 'btn-danger' : 'btn-outline-danger'"
                                        th:attr="data-id=${khoaHoc.khoahocId}">
                                        <i class="fas fa-heart me-1"></i>
                                        <span
                                            th:id="'like-count-' + ${khoaHoc.khoahocId}"
                                            th:text="${khoaHoc.luotThich != null ? khoaHoc.luotThich : 0}"></span>
                                    </button>

                                    <button type="button"
                                        class="btn btn-outline-primary btn-sm"
                                        data-bs-toggle="modal"
                                        th:data-bs-target="'#shareModal-' + ${khoaHoc.khoahocId}">
                                        <i class="fas fa-share me-1"></i>
                                    </button>

                                    <button
                                        class="btn btn-sm btn-outline-success add-to-cart-btn"
                                        th:attr="data-id=${khoaHoc.khoahocId},
                                             data-name=${khoaHoc.tenKhoaHoc},
                                             data-gia=${khoaHoc.giaKhuyenMai != null && khoaHoc.giaKhuyenMai > 0 ? khoaHoc.giaKhuyenMai : khoaHoc.giagoc},
                                             data-giagoc=${khoaHoc.giagoc},
                                             data-anh=${khoaHoc.anhBia},
                                             data-giangvien=${khoaHoc.giangVien.taikhoan.name}">
                                        <i class="fas fa-cart-plus me-1"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Modal chia s·∫ª -->
                        <div class="modal fade"
                            th:id="'shareModal-' + ${khoaHoc.khoahocId}"
                            tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <form th:action="@{/studend/share-course}"
                                        method="post" class="ajax-form">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Chia s·∫ª kh√≥a
                                                h·ªçc:
                                                <span
                                                    th:text="${khoaHoc.tenKhoaHoc}"></span>
                                            </h5>
                                            <button type="button"
                                                class="btn-close"
                                                data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <input type="hidden" name="courseId"
                                                th:value="${khoaHoc.khoahocId}" />
                                            <div class="mb-3">
                                                <label class="form-label">Email
                                                    ng∆∞·ªùi nh·∫≠n:</label>
                                                <input type="email"
                                                    name="recipientEmail"
                                                    class="form-control"
                                                    required
                                                    placeholder="nhapemail@example.com">
                                            </div>
                                            <p>Email s·∫Ω ch·ª©a li√™n k·∫øt ƒë·∫øn kh√≥a
                                                h·ªçc n√†y.</p>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button"
                                                class="btn btn-secondary"
                                                data-bs-dismiss="modal">ƒê√≥ng</button>
                                            <button type="submit"
                                                class="btn btn-primary fw-semibold">G·ª≠i
                                                Email</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>

            <div class="text-end mt-4">
                <a href="/giangvien/them-moi-khoa-hoc" class="btn btn-success">
                    ‚ûï Th√™m kh√≥a h·ªçc m·ªõi
                </a>
            </div>
            <style>
            .search-form {
                max-width: 1000px;
                margin: 0 auto;
            }
            
            .search-group {
                display: flex;
                align-items: center;
                /* border-radius: 50px; */
                overflow: hidden;
                /* box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); */
                background-color: #fff;
            }
            
            .search-group input.form-control {
                border: none;
                flex: 1;
                padding: 14px 20px;
                font-size: 16px;
                height: 48px;
                border-radius: 0;
            }
            
            .search-group input.form-control:focus {
                outline: none;
                box-shadow: none;
            }
            
            .search-group .btn {
                background-color: #198754;
                color: white;
                /* border: none; */
                /* padding: 0 30px; */
                height: 48px;
                font-size: 16px;
                font-weight: 500;
                /* border-radius: 0; */
            }
            
            .search-group .btn:hover {
                background-color: #157347;
            }
        </style>

        </main>
    </body>

</html>